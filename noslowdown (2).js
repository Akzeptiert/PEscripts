const module = new Module("NoSlowDown", true, true, ModuleCategory.PLAYER)
const web = new StateSetting("Web", false);
const soul_sand = new StateSetting("Soul sand", false)

module.setOnToggleListener(() => {
    Memory.patch(
        0xD3A7B4,
        module.isActive() ? [0x00, 0xBF, 0x00, 0xBF, 0x00, 0xBF, 0x00, 0xBF, 0x00, 0xBF, 0x00, 0xBF, 0x00, 0xBF, 0x00, 0xBF, 0x00, 0xBF, 0x00, 0xBF, 0x00, 0xBF, 0x00, 0xBF, 0x00, 0xBF, 0x00, 0xBF, 0x00, 0xBF] :
                            [0x9F, 0xED, 0x81, 0x0A, 0x00, 0x20, 0x95, 0xED, 0x01, 0x1A, 0x21, 0xEE, 0x00, 0x1A, 0x85, 0xED, 0x01, 0x1A, 0x95, 0xED, 0x02, 0x1A, 0x21, 0xEE, 0x00, 0x0A, 0x85, 0xED, 0x02, 0x0A]
    );
    Memory.patch(0x16F3058, module.isActive() && soul_sand.isActive() ? [0x70, 0x47] : [0x9F, 0xED]);
});
soul_sand.setOnStateToggleListener(active => {
    if (module.isActive())
        Memory.patch(0x16F3058, active ? [0x70, 0x47] : [0x9F, 0xED]);
});

function onLevelTick() {
    if (module.isActive() && web.isActive() && Memory.getLocalPlayer() != -1) {
        Memory.setBoolean(Memory.getLocalPlayer(), 344, false);
        Memory.setInt(Memory.getLocalPlayer(), 220, 0);
    }
}

function onScriptEnabled() {
    module.addSettings([web, soul_sand]);
    ModuleManager.addModule(module);
}

function onScriptDisabled() {
    ModuleManager.removeModule(module);    
}